<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Smocze W≈Ço≈õci</title>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background: #0a0f1a;
            color: #dfe8ff;
            display: flex;
        }

        /* Sidebar */
        #sidebar {
            width: 200px;
            background: #111a2b;
            height: 100vh;
            padding: 20px;
            box-sizing: border-box;
            position: fixed;
            right: 0;
            top: 0;
            display: none;
            border-left: 2px solid #cfd8ff;
        }

        #sidebar h2 {
            text-align: center;
            color: #cfd8ff;
        }

        .tab {
            padding: 10px;
            margin: 10px 0;
            background: #16233a;
            cursor: pointer;
            text-align: center;
            border-radius: 6px;
            border: 1px solid #cfd8ff;
            transition: 0.2s;
        }

        .tab:hover {
            background: #1f3357;
        }

        /* Content */
        #content {
            flex: 1;
            padding: 20px;
            margin-right: 220px;
        }

        .tab-content {
            display: none;
        }

        /* Fantasy dialog window */
        .dialog-window {
            background: rgba(10, 20, 40, 0.85);
            border: 2px solid #cfd8ff;
            border-radius: 14px;
            padding: 20px;
            max-width: 600px;
            margin: 20px auto;
            box-shadow: 0 0 20px rgba(150, 170, 255, 0.4);
            animation: fadeIn 0.4s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .dialog-title {
            font-size: 22px;
            color: #cfd8ff;
            border-bottom: 1px solid #cfd8ff;
            padding-bottom: 8px;
            margin-bottom: 15px;
            text-align: center;
        }

        .dialog-text {
            font-size: 16px;
            line-height: 1.5;
            margin-bottom: 20px;
        }

        .dialog-button {
            display: block;
            width: 100%;
            padding: 12px;
            margin: 8px 0;
            background: linear-gradient(#1a2d4d, #0f1b33);
            border: 1px solid #cfd8ff;
            border-radius: 8px;
            color: #dfe8ff;
            cursor: pointer;
            text-align: center;
            transition: 0.2s;
        }

        .dialog-button:hover {
            background: #243b63;
            box-shadow: 0 0 10px rgba(150, 170, 255, 0.4);
        }

        /* Smoki table */
        .dragon-slot {
            background: rgba(10, 20, 40, 0.7);
            border: 1px solid #cfd8ff;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .button {
            background: #1a2d4d;
            padding: 10px 15px;
            border-radius: 6px;
            border: 1px solid #cfd8ff;
            cursor: pointer;
            display: inline-block;
            margin-top: 10px;
            transition: 0.2s;
        }

        .button:hover {
            background: #243b63;
        }

        input.name-input {
            padding: 8px;
            margin-top: 10px;
            width: 200px;
            background: #0f1b33;
            border: 1px solid #cfd8ff;
            color: #dfe8ff;
            border-radius: 6px;
        }
    </style>
</head>
<body>

<div id="content">
    <h1>Witaj w Smoczych W≈Ço≈õciach</h1>
    <div id="intro"></div>

    <div id="world" class="tab-content">
        <h2>≈öwiat</h2>
        <p>Tu pojawi siƒô mapa ≈õwiata.</p>
    </div>

    <div id="dragons" class="tab-content">
        <h2>Smoki</h2>
        <div id="dragons-list"></div>
    </div>

    <div id="home" class="tab-content">
        <h2>Dom</h2>
        <div id="home-content"></div>
    </div>

    <div id="work" class="tab-content">
        <h2>Praca</h2>
        <p>Tu bƒôdƒÖ misje.</p>
    </div>

    <div id="merchant" class="tab-content">
        <h2>Handlarz Smoczych Jaj</h2>
        <div id="merchant-content"></div>
    </div>
</div>

<div id="sidebar">
    <h2>Zak≈Çadki</h2>
    <div class="tab" onclick="openTab('world')">≈öwiat</div>
    <div class="tab" onclick="openTab('dragons')">Smoki</div>
    <div class="tab" onclick="openTab('home')">Dom</div>
    <div class="tab" onclick="openTab('work')">Praca</div>
    <div class="tab" onclick="openTab('merchant')">Handlarz</div>
</div>

<script>
/* ------------------------------
   STARTOWY SYSTEM PIERWSZEGO SMOKA
--------------------------------*/
const questions = [
    {
        text: "WƒôdrujƒÖc przez g√≥ry Sarak, napotykasz porzucone obozowisko. Co robisz?",
        answers: [
            { text: "Szukam ≈õlad√≥w walki. Ogie≈Ñ mnie prowadzi.", element: "ogien" },
            { text: "Szukam mokrych ≈õlad√≥w. Woda zna drogƒô.", element: "woda" },
            { text: "Ws≈Çuchujƒô siƒô w ziemiƒô.", element: "ziemia" },
            { text: "PodƒÖ≈ºam za wiatrem.", element: "powietrze" }
        ]
    },
    {
        text: "W ruinach ≈õwiƒÖtyni s≈Çyszysz d≈∫wiƒôk. Co robisz?",
        answers: [
            { text: "Wchodzƒô bez wahania.", element: "ogien" },
            { text: "Szukam wilgoci.", element: "woda" },
            { text: "Dotykam kamieni.", element: "ziemia" },
            { text: "S≈Çucham echa.", element: "powietrze" }
        ]
    },
    {
        text: "Na rozdro≈ºu spotykasz wƒôdrowca. Co robisz?",
        answers: [
            { text: "Pytam o drogƒô.", element: "ogien" },
            { text: "P≈Çynƒô z losem.", element: "woda" },
            { text: "S≈Çucham historii.", element: "ziemia" },
            { text: "Idƒô za intuicjƒÖ.", element: "powietrze" }
        ]
    }
];

let currentQuestion = 0;
let elementScores = { ogien: 0, woda: 0, ziemia: 0, powietrze: 0 };

let chosenDragon = localStorage.getItem("chosenDragon");
let dragonName = localStorage.getItem("dragonName") || "Tw√≥j Smok";

let eggHeats = Number(localStorage.getItem("eggHeats")) || 0;
let lastHeat = Number(localStorage.getItem("lastHeat")) || 0;

/* ------------------------------
   DRUGI SMOK ‚Äî ZMIENNE
--------------------------------*/
let secondDragonUnlocked = localStorage.getItem("secondDragonUnlocked") === "true";
let secondDragonElement = localStorage.getItem("secondDragonElement") || null;
let secondEggHeats = Number(localStorage.getItem("secondEggHeats")) || 0;
let secondLastHeat = Number(localStorage.getItem("secondLastHeat")) || 0;
let secondDragonName = localStorage.getItem("secondDragonName") || "Drugi Smok";

/* ------------------------------
   START GRY
--------------------------------*/
function showQuestion() {
    if (chosenDragon) {
        startGame();
        return;
    }

    const intro = document.getElementById("intro");
    const q = questions[currentQuestion];

    let html = `<div class='dialog-window'>
        <div class='dialog-title'>Pytanie ${currentQuestion + 1}</div>
        <div class='dialog-text'>${q.text}</div>`;

    q.answers.forEach(a => {
        html += `<div class='dialog-button' onclick='chooseAnswer("${a.element}")'>${a.text}</div>`;
    });

    html += "</div>";
    intro.innerHTML = html;
}

function chooseAnswer(element) {
    elementScores[element]++;
    currentQuestion++;

    if (currentQuestion < questions.length) showQuestion();
    else finalizeDragon();
}

function finalizeDragon() {
    const intro = document.getElementById("intro");

    const chosen = Object.entries(elementScores).sort((a,b)=>b[1]-a[1])[0][0];
    chosenDragon = chosen;
    localStorage.setItem("chosenDragon", chosen);

    intro.innerHTML = `
        <div class='dialog-window'>
            <div class='dialog-title'>Tw√≥j smok</div>
            <div class='dialog-text'>Wybra≈Çe≈õ ≈ºywio≈Ç: <b>${chosen}</b></div>
        </div>
    `;

    setTimeout(startGame, 1500);
}

function startGame() {
    document.getElementById("sidebar").style.display = "block";
    document.getElementById("intro").style.display = "none";

    updateDragonsTab();
    updateHomeTab();
    updateMerchantTab();
}

/* ------------------------------
   ZAK≈ÅADKA SMOKI
--------------------------------*/
function updateDragonsTab() {
    const list = document.getElementById("dragons-list");

    let html = "";

    html += `
        <div class="dragon-slot">
            <b>Smok 1:</b><br>
            Imiƒô: ${dragonName}<br>
            ≈ªywio≈Ç: ${chosenDragon}<br>
            Status: ${eggHeats < 3 ? "Jajko" : "Wykluty smok"}
        </div>
    `;

    html += `
        <div class="dragon-slot">
            <b>Smok 2:</b><br>
            ${secondDragonUnlocked ?
                `Imiƒô: ${secondDragonName}<br>
                 ≈ªywio≈Ç: ${secondDragonElement}<br>
                 Status: ${secondEggHeats < 3 ? "Jajko" : "Wykluty smok"}`
                :
                "üîí Zablokowany ‚Äî odwied≈∫ Handlarza"
            }
        </div>
    `;

    html += `
        <div class="dragon-slot">
            <b>Smok 3:</b><br>
            üîí Zablokowany
        </div>
    `;

    list.innerHTML = html;
}

/* ------------------------------
   ZAK≈ÅADKA DOM
--------------------------------*/
function updateHomeTab() {
    const home = document.getElementById("home-content");

    let html = "";

    /* Smok 1 */
    html += `
        <div class="dragon-slot">
            <b>Smok 1</b><br>
            Ogrzania: ${eggHeats}/3<br>
            ${eggHeats < 3 ?
                `<div class="button" onclick="heatEgg1()">Ogrzej jajko</div>`
                :
                `<div>Smok wykluty</div>
                 <input class="name-input" id="name1" placeholder="Nowe imiƒô">
                 <div class="button" onclick="renameDragon1()">Zmie≈Ñ imiƒô</div>`
            }
        </div>
    `;

    /* Smok 2 */
    if (secondDragonUnlocked) {
        html += `
            <div class="dragon-slot">
                <b>Smok 2</b><br>
                Ogrzania: ${secondEggHeats}/3<br>
                ${secondEggHeats < 3 ?
                    `<div class="button" onclick="heatEgg2()">Ogrzej jajko</div>`
                    :
                    `<div>Smok wykluty</div>
                     <input class="name-input" id="name2" placeholder="Nowe imiƒô">
                     <div class="button" onclick="renameDragon2()">Zmie≈Ñ imiƒô</div>`
                }
            </div>
        `;
    }

    home.innerHTML = html;
}

function heatEgg1() {
    const now = Date.now();
    if (now - lastHeat < 60000) return;

    eggHeats++;
    lastHeat = now;

    localStorage.setItem("eggHeats", eggHeats);
    localStorage.setItem("lastHeat", lastHeat);

    updateHomeTab();
    updateDragonsTab();
}

function heatEgg2() {
    const now = Date.now();
    if (now - secondLastHeat < 60000) return;

    secondEggHeats++;
    secondLastHeat = now;

    localStorage.setItem("secondEggHeats", secondEggHeats);
    localStorage.setItem("secondLastHeat", secondLastHeat);

    updateHomeTab();
    updateDragonsTab();
}

function renameDragon1() {
    const newName = document.getElementById("name1").value.trim();
    if (!newName) return;

    dragonName = newName;
    localStorage.setItem("dragonName", newName);

    updateHomeTab();
    updateDragonsTab();
}

function renameDragon2() {
    const newName = document.getElementById("name2").value.trim();
    if (!newName) return;

    secondDragonName = newName;
    localStorage.setItem("secondDragonName", newName);

    updateHomeTab();
    updateDragonsTab();
}

/* ------------------------------
   HANDLARZ ‚Äî PYTANIA
--------------------------------*/
const merchantQuestions = [
    {
        text: "Wchodzisz do jaskini pe≈Çnej staro≈ºytnych run. Co robisz?",
        answers: [
            { text: "Dotykam najja≈õniejszej runy ‚Äî ogie≈Ñ.", element: "ogien" },
            { text: "Szukam wilgoci ‚Äî woda.", element: "woda" },
            { text: "Badam ska≈Çy ‚Äî ziemia.", element: "ziemia" },
            { text: "Nas≈Çuchujƒô echa ‚Äî powietrze.", element: "powietrze" }
        ]
    },
    {
        text: "Na pustkowiu widzisz wir energii. Co robisz?",
        answers: [
            { text: "Wchodzƒô w niego ‚Äî ogie≈Ñ mnie nie zatrzyma.", element: "ogien" },
            { text: "Obserwujƒô jego ruch ‚Äî jak woda.", element: "woda" },
            { text: "Dotykam ziemi, by poczuƒá drgania.", element: "ziemia" },
            { text: "Pozwalam wiatrowi mnie poprowadziƒá.", element: "powietrze" }
        ]
    },
    {
        text: "Spotykasz ducha staro≈ºytnego smoka. Co robisz?",
        answers: [
            { text: "Patrzƒô mu prosto w oczy ‚Äî ogie≈Ñ.", element: "ogien" },
            { text: "S≈Çucham jego szept√≥w ‚Äî woda.", element: "woda" },
            { text: "K≈Çaniam siƒô mu ‚Äî ziemia.", element: "ziemia" },
            { text: "Pozwalam mu przej≈õƒá przez siebie ‚Äî powietrze.", element: "powietrze" }
        ]
    }
];

let merchantStep = 0;
let merchantScores = { ogien: 0, woda: 0, ziemia: 0, powietrze: 0 };

function updateMerchantTab() {
    const box = document.getElementById("merchant-content");

    if (secondDragonUnlocked) {
        box.innerHTML = `
            <div class="dialog-window">
                <div class="dialog-title">Handlarz</div>
                <div class="dialog-text">Masz ju≈º drugiego smoka.</div>
            </div>
        `;
        return;
    }

    box.innerHTML = `
        <div class="dialog-window">
            <div class="dialog-title">Handlarz</div>
            <div class="dialog-text">
                ‚ÄûWitaj, podr√≥≈ºniku. Widzƒô, ≈ºe masz ju≈º jednego smoka.
                Je≈õli chcesz kolejnego, muszƒô poznaƒá tw√≥j ≈ºywio≈Ç.‚Äù
            </div>
            <div class="dialog-button" onclick="merchantNext()">Dalej</div>
        </div>
    `;
}

function merchantNext() {
    const box = document.getElementById("merchant-content");

    if (merchantStep < 3) {
        const q = merchantQuestions[merchantStep];

        box.innerHTML = `
            <div class="dialog-window">
                <div class="dialog-title">Pytanie ${merchantStep + 1}</div>
                <div class="dialog-text">${q.text}</div>
                ${q.answers.map(a => `
                    <div class="dialog-button" onclick="merchantChoose('${a.element}')">${a.text}</div>
                `).join("")}
            </div>
        `;
        return;
    }

    // Je≈õli 3 pytania zosta≈Çy zako≈Ñczone ‚Üí obliczamy ≈ºywio≈Ç
    const chosen = Object.entries(merchantScores).sort((a,b)=>b[1]-a[1])[0][0];
    const elementName = {
        ogien: "ognistego",
        woda: "wodnego",
        ziemia: "ziemnego",
        powietrze: "powietrznego"
    }[chosen];

    box.innerHTML = `
        <div class="dialog-window">
            <div class="dialog-title">Potwierdzenie</div>
            <div class="dialog-text">
                ‚ÄûWidzƒô, ≈ºe tw√≥j duch jest bliski ≈ºywio≈Çowi <b>${chosen.toUpperCase()}</b>.<br>
                Czy na pewno chcesz otrzymaƒá <b>Jajo ${elementName} smoka</b>?‚Äù
            </div>
            <div class="dialog-button" onclick="merchantConfirm('${chosen}')">TAK</div>
            <div class="dialog-button" onclick="updateMerchantTab()">NIE</div>
        </div>
    `;
}

function merchantChoose(element) {
    merchantScores[element]++;
    merchantStep++;
    merchantNext();
}

function merchantConfirm(element) {
    secondDragonUnlocked = true;
    secondDragonElement = element;
    secondEggHeats = 0;
    secondLastHeat = 0;

    localStorage.setItem("secondDragonUnlocked", "true");
    localStorage.setItem("secondDragonElement", element);
    localStorage.setItem("secondEggHeats", "0");
    localStorage.setItem("secondLastHeat", "0");

    const box = document.getElementById("merchant-content");
    box.innerHTML = `
        <div class="dialog-window">
            <div class="dialog-title">Handlarz</div>
            <div class="dialog-text">
                ‚ÄûDobrze. Oto twoje jajo. Dbaj o nie, a wykluje siƒô potƒô≈ºny smok.‚Äù
            </div>
        </div>
    `;

    updateDragonsTab();
    updateHomeTab();

}
showQuestion();

</script>
</body>
</html>
